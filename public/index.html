<!DOCTYPE html>
<html lang="en">
<head>
    <title>Digital Twins Admin</title>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="css/styles.css" />
    <script
            src="https://code.jquery.com/jquery-3.6.1.min.js"
            integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
            crossorigin="anonymous"></script>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="content-container">
        <div class="change-screen-button-wrapper">
            <span class="screen-title">Change Screen: </span>
            <select class="screen-select"></select>
        </div>
        <div class="selector" id="displaySelect"></div>
        <div class="avatar-list-wrapper" id="avatarList">
            <div class="chair-button one chair-button-on" seat="seat01">
                <span>On</span>
            </div>
            <div class="chair-button two chair-button-on" seat="seat02">
                <span>On</span>
            </div>
            <div class="chair-button three chair-button-on" seat="seat03">
                <span>On</span>
            </div>
            <div class="chair-button four chair-button-on" seat="seatCenter">
                <span>On</span>
            </div>
            <div class="chair-button five chair-button-on" seat="seat04">
                <span>On</span>
            </div>
            <div class="chair-button six chair-button-on" seat="seat05">
                <span>On</span>
            </div>
            <div class="chair-button seven chair-button-on" seat="seat06">
                <span>On</span>
            </div>
        </div>
        <div class="avatar-template-list-wrapper" id="avatarTemplateList">
            <div class="avatar-select-block">
                <select class="avatar-select" seat="seat01"></select>
            </div>
            <div class="avatar-select-block">
                <select class="avatar-select" seat="seat02"></select>
            </div>
            <div class="avatar-select-block">
                <select class="avatar-select" seat="seat03"></select>
            </div>
            <div class="avatar-select-block">
                <select class="avatar-select" seat="seatCenter"></select>
            </div>
            <div class="avatar-select-block">
                <select class="avatar-select" seat="seat04"></select>
            </div>
            <div class="avatar-select-block">
                <select class="avatar-select" seat="seat05"></select>
            </div>
            <div class="avatar-select-block">
                <select class="avatar-select" seat="seat06"></select>
            </div>
        </div>
    </div>
    <script>
        jQuery(document).ready(function () {
            const socket = io.connect("http://localhost:8080");
            const avatarTemplateList = ["Disabled", "Basic"];
            const screenList = ["Screen 01", "Screen 02", "Screen 03", "Screen 04", "Screen 05", "Screen 06", "Screen 07"];
            const stageParameters = {
                seatCenter: {
                    id: 0,
                    avatarTemplate: "Disabled",
                    chairEnabled: true
                },
                seat01: {
                    id: 1,
                    avatarTemplate: "Disabled",
                    chairEnabled: true
                },
                seat02: {
                    id: 2,
                    avatarTemplate: "Disabled",
                    chairEnabled: true
                },
                seat03: {
                    id: 3,
                    avatarTemplate: "Disabled",
                    chairEnabled: true
                },
                seat04: {
                    id: 4,
                    avatarTemplate: "Disabled",
                    chairEnabled: true
                },
                seat05: {
                    id: 5,
                    avatarTemplate: "Disabled",
                    chairEnabled: true
                },
                seat06: {
                    id: 6,
                    avatarTemplate: "Disabled",
                    chairEnabled: true
                },
                screen: {
                    url: ""
                },
                customData: {

                }
            };

            let elementScreenSelect = $('.screen-select');
            let elementScreenTitle = $('.screen-title');


            let selectedScreen = elementScreenSelect.val();
            elementScreenTitle.text(screenList[0]);
            stageParameters.screen.url = selectedScreen;

            elementScreenSelect.on('change', () => {
                selectedScreen = elementScreenSelect.val();
                elementScreenTitle.text(selectedScreen);
                stageParameters.screen.url = selectedScreen;
                socket.emit("updateStageParameters", stageParameters);
            });

            for (let element of $('.chair-button')) {
                jQuery(element).on('click', function() {
                    let chairElement = jQuery(this);

                    if (stageParameters[chairElement.attr('seat')].chairEnabled) {
                        stageParameters[chairElement.attr('seat')].chairEnabled = false;
                        jQuery(this).removeClass("chair-button-on");
                        chairElement.text("Off");
                    } else {
                        stageParameters[chairElement.attr('seat')].chairEnabled = true;
                        jQuery(this).addClass("chair-button-on");
                        chairElement.text("On");
                    }

                    console.log(stageParameters);
                });
            }

            for (let element of $('.avatar-select')) {
                for (let avatarTemplate of avatarTemplateList) {
                    element.append(new Option(avatarTemplate));
                }
                jQuery(element).on('change', function() {
                    let avatarElement = jQuery(this);

                    stageParameters[avatarElement.attr('seat')].avatarTemplate =
                        avatarElement.val();

                    console.log(stageParameters);
                    socket.emit("updateStageParameters", stageParameters);
                });
            }

            for (let screenName of screenList) {
                elementScreenSelect.append(new Option(screenName));
            }
        });
    </script>
</body>
</html>
